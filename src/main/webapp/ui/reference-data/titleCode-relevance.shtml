<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Title Code Reference</title>
                
        <!--#include virtual="../common/header.html" -->
        <!--        http://www.datatables.net/blog/2012-05-31 -->
        <!-- pace CSS (this is only used on DataTable pages) -->
<!--         <link rel="stylesheet" href="../stylesheets/site.css">    -->

    </head>

    <body>
        <!--#include virtual="../common/nav.html" -->
        <!-- Begin page content -->
        <div class="container-fluid" id="main">
            
            <div class="row-fluid">
                    <div class="page-header"> 
                          <h1>Title Code Reference</h1>
                    </div>
                                     
                 		
                    <div id="table-scroll-area">
                        <table id="title-code-table" class="display nowrap" cellspacing="0" width="100%">
                            <thead>
                                <tr> 
                                    <th>Edit</th>
                                    <th>Title Code ID</th>
                                    <th>Title Code</th>
                                    <th>Title Display Text</th>
                                    <th>Payroll Title Description</th>
                                    <th>Payroll Title Short Description</th>
                                    <th>Series Type ID</th>
                                    <th>Rank Type ID</th>
                                    <th>Is Unit18 Continuing</th>
                                    <th>Is Unit18</th>
                                    <th>Is UCLA Valid</th>
                                    <th>Is Tenure</th>
                                    <th>Is Senate</th>
                                    <th>Is Security of Employment</th>
                                    <th>Is Opus Valid</th>
                                    <th>Is Ladder</th>
                                    <th>Is HSCP</th>
                                    <th>Is Emeritus</th>
                                    <th>Is Eligibility Exclude</th>
                                    <th>Is Active</th>
                                    <th>Is Academic Administrative</th>
                                    <th>Is Academic</th>
                                    <th>Is 8YearLimit</th>
                                    <th>Appointment Basis Type ID</th>
                                </tr>
                                <tr> 
                                    <td class="column-filter"></td>
                                	<td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                    <td class="column-filter"></td>
                                </tr>
                            </thead>
                            <tbody>
                                
                            </tbody>
                        </table>
                    </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="infoModal" tabindex="-1" role="dialog" aria-labelledby="infoModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="infoModalLabel">Please Note</h4>
                    </div>                     
                </div>
            </div>
        </div>
                
        <!-- Generic Error -->    
        <div class="modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" id="error">
            <div class="modal-dialog ">
                <div class="modal-content">
                    <div class="modal-header modal-danger">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h2 class="white">Error</h2>
                    </div>
                    <div class="modal-body">                    
                    </div> <!-- /modal-body -->
                    <div class="modal-footer">                    
                        <button type="button" class="cancel btn btn-link left" data-dismiss="modal">Ok</button>
                    </div> 
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->  
        

        
        
        <!--#include virtual="relevance-modals.html" -->
                
        <!--#include virtual="../common/footer.html" -->

        <!--#include virtual="../common/js-includes.html" -->
        <!--#include virtual="../common/jquery-datatables.html" -->
        <script src="relevance-logic.js"></script>
                             
        <!-- JavaScript Functionality -->
        <script> 
        
        //responsive table height upon load
        $ (document).ready(function() {
      	  console.log($(window).height());
      	  $('.dataTables_scrollBody').css('height', ($(window).height() - 350));
         });
      
      //responsive table height upon window resize
        $(window).resize(function() {
        	  console.log($(window).height());
        	  $('.dataTables_scrollBody').css('height', ($(window).height() - 350));
        	}); 
      
        var rankTypeDataRows ;
        var table;
        var pageName = 'titleCode';
            function initializeTables() { 
            	if (adminData.dashboardRole = "OA" && adminData.adminRoles.indexOf("opus_admin")>=0) {
	                populateTableData();
            	} else {
            		 window.location.assign("/opusWeb/ui/error/access-error.shtml");
            	}
            }
            
            function populateTableData() {
                console.log("Before call: " + new Date($.now()));
                var SendInfo = {
                
                }; 
                $.ajax({
                    cache:false,
                    url: "/restServices/rest/admin/getTitleCodeRef/?access_token="+access_token, 
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json',
                    mimeType: 'application/json',
                    success: function(adminScreenData) {
                        if (adminScreenData == "") {                    
                            window.location.assign("/opusWeb/ui/error/access-error.shtml");       
                        }
                        
                        var aName = adminData.adminName;     
                        if (aName > "") {  
                            $('#adminName').html(aName);
                            $("#nav-logout").show();
                        }  
                        titleCodeDataRows = adminScreenData;                        
                        initializeTable(titleCodeDataRows); 
                    },
                    error:function(jqXHR, textStatus, errorThrown) {
                        if (jqXHR.responseText !== "") {  
                                $("#error .modal-body").empty();
                                $("#error .modal-body").append(jqXHR.responseText);
                                $('#error').modal('show');
                                console.log("Error: ", errorThrown);
                                console.log(jqXHR); 
                                console.log("Text Status: ", textStatus);
                        } else {                            
                                console.log("Error: ", errorThrown);
                                console.log(jqXHR); 
                                console.log("Text Status: ", textStatus);              
                                window.location.assign("/opusWeb/ui/error/access-error.shtml");     
                        }  
                    } 
                });
            }
            
      
                                    
            function initializeTable(inputData) {
                table = $('#title-code-table').DataTable( {
                    aaData: inputData,
                    dom: 'frtiS',
                   // bPaginate: false, // include if no pagination
                    pageResize: true,
                    "sScrollY": ($(window).height() - 350),
                    scrollX:        true, // allow horizontal scrolling
                    "orderClasses": false, // Always turn this off.  It highlights the sorted column.  Causes slowness.
                  //  scrollCollapse: true, // if have Fixed Columns
                    columns: [
							{data: "edit", 
								sDefaultContent:"",
									mRender:	function (data, type, full) {
														return '<a role="button" data-container="body" aria-label="help tip" trigger="hover" data-trigger="hover" tabindex="0" class="ttip" data-placement="top" data-toggle="popover" white-space="pre-wrap" data-html="true" data-content="View/Edit"><button type="button" class="btn btn-default edit-case-button" data-toggle="modal" data-target="#edit-ref-modal" onclick="setEditRefValues('+ full.TitleCodeId + ',\'\',\'' + full.TitleCode +'\',\'' + full.PayrollTitleDescription +'\',\''+full.TitleDisplayText+'\',\''+full.IsActive+'\',\''+'edit' + '\',\''+full.IsHSCP+'\',\'\')"> <span aria-label="View/Edit" title="View/Edit" class="icon-pencil ttip"></span></button></a>';
												},
												name: "edit"
							},  
							{data: "TitleCodeId"},
							{data: "TitleCode"},
							{data: "TitleDisplayText"},
							{data: "PayrollTitleDescription"},
							{data: "PayrollTitleShortDescription"},
							{data: "SeriesTypeId"},
							{data: "RankTypeId"},
							{data: "IsUnit18Continuing"},
							{data: "IsUnit18"},
							{data: "IsUCLAValid"},
							{data: "IsTenure"},
							{data: "IsSenate"},
							{data: "IsSecurityOfEmployment"},
							{data: "IsOpusValid"},
							{data: "IsLadder"},
							{data: "IsHSCP"},
							{data: "IsEmeritus"},
							{data: "IsEligibilityExclude"},
							{data: "IsActive"},
							{data: "IsAcademicAdministrative"},
							{data: "IsAcademic"},
							{data: "Is8YearLimit"},
							{data: "AppointmentBasisTypeId"} 
                    ],
                    columnDefs: [{
                        "targets": 'nosort',
                        "orderable": false
                    }],
                    order: [[1, 'asc'],[0, 'asc']],
                    bSortCellsTop: true, //Sort on the top header cell (not the bottom)
                    sAjaxDataProp: "", //Use blank instead of aaData as array name
                    lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "All"]], //Show # of entries
                    iDisplayLength: 25, //Show # of entries default
                    fnInitComplete: function(oSettings, json) { 
                        //For some reason, we have to re-initialize the table or it gives an 'undefined' error
                        var table = $('#title-code-table').DataTable();
                                                              
                    }
                });
                
               //  new $.fn.dataTable.FixedColumns( table); //needed to fix double header issue
         
                 //Export button
             /*   var tt = new $.fn.dataTable.TableTools(table, {
                    "aButtons": [
                                    {
                                        "sExtends": "collection",
                                        "aButtons":[
                                            {
                                                "sExtends": "xls",
                                                "oSelectorOpts": {
                                                    "filter": "applied"
                                                }, //Exports filtered rows, if applicable
                                                "mColumns":"visible" //Only exports visible columns
                                            } 
                                        ]
                                    }
                                ],
                                "sSwfPath": "../plugins/DataTables-1.10.3/extensions/TableTools/swf/copy_csv_xls_pdf.swf" //Use the .swf file for xls and pdf
                            });
                $(tt.fnContainer()).insertAfter('.dataTables_filter'); */        
                console.log("After call: " + new Date($.now()));
            }
            
	        
        </script>
    </body>
</html>
